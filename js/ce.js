/* 
Onscreen Editing Tool version 5.3
created by Aleksey Bobrov
*/
var site_id,epage,ce;
(function(){function e(a){/admin\.aisreporting\.com/.test(a.origin)&&("css"==a.data.type?($("body > style:last-child").remove(),$("body").append("<style>"+a.data.msg+"</style>")):"style"==a.data.type&&$("head").children("link").each(function(){if(0<=$(this).attr("href").indexOf("style.css"))return $(this).attr("href","/c/style.css?R="+100*Math.random()),!1}))}function d(){tinymce.init({extended_valid_elements:"b,span[style],ce[oet],strike",selector:"#content_1",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen",
"insertdatetime media nonbreaking save table contextmenu directionality","template paste textcolor addimage"],toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | forecolor link image addimage print preview code",content_css:"https://admin.aisreporting.com/cgi-bin/tools/getcss.pl?SITE_ID="+site_id,browser_spellcheck:!0,forced_root_block:!1,image_list:"/cgi-bin/r/util/get-image.pl?ACTION=LISTIMAGE&SITE_ID="+site_id,site_id:site_id,convert_urls:!1,
paste_as_text:!0})}window.top!==window.self&&window.addEventListener("message",e,!1);ce=ce||{kp:!1,path:"/cgi-bin/r/tools/ce/ce.pl",sload:0,content_editor:function(a){var b=$(a.target);b.closest("ce").length&&(b=b.closest("ce"));$("#editor_edit1").length&&$("#editor_edit1").removeAttr("id");b.attr("id","editor_edit1");ce.dtree=b.parents().map(function(){var a="",b="",c;$(this).attr("class")&&(a=$(this).attr("class"));$(this).attr("id")&&(b=$(this).attr("id"));c=this.tagName;a&&(c=c+"(class="+a+")");
b&&(c=c+"(id="+b+")");return c}).get().join(",<br>");$("#editor").length?$("#editor").html(""):$("body").append("<div id='editor'><img src='https://admin.aisreporting.com/i/oclose.png' id='oclose'/></div>");$("#editor").draggable({revert:!1,cancel:"textarea, input, .nicEdit-main, img, a, #editor div"});$.ajax({url:ce.path,type:"post",data:"ACTION=VERIFY&SITE_ID="+site_id,success:function(a){$("#editor").html($("#editor").html()+a.substring(1));$("#editor textarea[name=etext1]").length&&($("textarea[name=etext1]").text(b.text().replace(/&amp;/g,
"&")),$("#content_1").text(b.html()),ce.thtml=b.html().replace(/&amp;/g,"&"),ce.phtml=b.prev().html(),ce.mhtml=b.html().replace(/<b>/g,"").replace(/<\/b>/g,"").replace(/<\/u>/g,"").replace(/<u>/g,"").replace(/<\/i>/g,"").replace(/<i>/g,"").replace(/<\/strike>/g,"").replace(/<strike>/g,"").replace(/&amp;/g,"&").replace(/<br>/g,"").replace(/<br\/>/g,""),ce.phtml||(ce.phtml=b.next().html()),ce.phtml||(ce.phtml=b.parent().html()),(a=b.attr("oet"))&&$("#editor").attr("oet",a),"undefined"==typeof tinymce?
$.ajax({url:"/js/tinymce/tinymce.min.js",dataType:"script",cache:!0,success:function(){tinymce.baseURL=location.protocol+"//"+location.hostname+"/js/tinymce";tinymce.suffix=".min";d()}}):d(),"function"==typeof test_change&&test_change());$("#editor").css({top:$(window).height()/2-250+"px",left:$(window).width()/2-250+"px"})}})}};$(document).ready(function(){$.ajax({url:ce.path,type:"post",data:"ACTION=CHECKSTATE&SITE_ID="+site_id,success:function(a){ce.checkres=a;1!=a&&2!=a||!$("ce").length||$("body").append("<div id='ce-highlight'>CE</div>");
2==a&&"function"==typeof window.establish_connection&&establish_connection()}});$(document).bind("click",function(a){a.altKey&&ce.kp&&(a.preventDefault(),site_id?epage&&epage.length?$(a.target).text().length&&ce.content_editor(a):alert("Page Name is missing, update requests are disabled."):alert("Website ID is missing, update requests are disabled."))});$("input[name=editor_update]").live("click",function(){$.ajax({url:ce.path,type:"post",cache:!1,data:"SITE_ID="+site_id+"&PAGE="+epage+"&OTEXT="+
encodeURIComponent($("textarea[name=etext1]").val())+"&NTEXT="+encodeURIComponent(tinymce.get("content_1").getContent())+"&TREE="+encodeURIComponent(ce.dtree)+"&THTML="+encodeURIComponent(ce.thtml)+"&PHTML="+encodeURIComponent(ce.phtml)+"&MHTML="+encodeURIComponent(ce.mhtml)+"&OET="+$("#editor").attr("oet"),success:function(a){tinymce.EditorManager.execCommand("mceRemoveEditor",!0,"content_1");$("#editor").remove();confirm(a)&&(location.href=epage.replace(/^.*\/cgi-bin\//,"/cgi-bin/"))}})});$("input[name=editor_preview]").live("click",
function(){"Preview"==$(this).val()?($("#editor_edit1").html(tinymce.get("content_1").getContent()),$(this).val("Back to Original")):($("#editor_edit1").html(ce.thtml),$(this).val("Preview"))});$("input[name=editor_close]").live("click",function(){"undefined"!==typeof tinymce&&tinymce.EditorManager.execCommand("mceRemoveEditor",!0,"content_1");$("#editor").remove()});$("#oclose").live("click",function(){"undefined"!==typeof tinymce&&tinymce.EditorManager.execCommand("mceRemoveEditor",!0,"content_1");
$(this).parent().remove()});$("input[name=elogout]").live("click",function(){cookiePath=";Path=/";document.cookie="aiscookie=0"+cookiePath;location.reload(!1)});$(document).keydown(function(a){81==a.which&&(ce.kp=!0)}).keyup(function(a){81==a.which&&(ce.kp=!1)});$("#ce-highlight").live("click",function(){$(this).toggleClass("sel");$("ce").toggleClass("sel")});$("#ce-highlight").live("mouseenter",function(){$("body").append("<div id='ce-msg'><div id='arrow'></div><div class='body'><span>For Administrators Only</span><br>As an administrator of this website, this widget will assist you with using the Onscreen Editor Tool. By clicking this button, containers of the content will highlight with a green dotted border allowing for you to edit larger chunks of the page. To grab the larger chunks, while pressing &ldquo;ALT Q&rdquo;, click on the top green border. Note that not all pages have this feature enabled. If you have any question please email webteam@ovistechnologies.com.<br>***Normal users do not see this button***</div><div class='mbottom'></div></div>");
$(this).mouseleave(function(){$("#ce-msg").remove()})})})})();